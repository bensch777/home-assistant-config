- id: 52b07f8689be4ab39d46f75410a4267a
  alias: 'Sonos: Set alarm'
  trigger:
  - entity_id: input_boolean.alarm_clock_status
    platform: state
    to: 'on'
  action:
  - data_template:
      alarm_id: 1469
      enabled: true
      entity_id: media_player.schlafzimmer
      time: '{{ states.input_datetime.alarm_clock_time.state }}'
    service: sonos.update_alarm
- alias: 'Sonos: Disable alarm'
  trigger:
  - platform: state
    entity_id: input_boolean.alarm_clock_status
    to: 'off'
  action:
    service: sonos.update_alarm
    data_template:
      entity_id: media_player.schlafzimmer
      alarm_id: 1469
      enabled: false
  id: a1da7a3639f34a9eb3f7603a44c31e78
- id: '1594064894682'
  alias: 'Sonos: Set alarm time'
  description: ''
  trigger:
  - entity_id: input_datetime.alarm_clock_time
    platform: state
  condition: []
  action:
  - delay: 00:00:20
  - data_template:
      alarm_id: 1469
      entity_id: media_player.schlafzimmer
      time: '{{ states.input_datetime.alarm_clock_time.state }}'
    service: sonos.update_alarm
- id: '1594380522401'
  alias: 'Security: Door opened but we are not home'
  description: ''
  trigger:
  - entity_id: binary_sensor.openclose_4
    from: 'off'
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: group.persons
    state: not_home
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'off'
  action:
  - data:
      message: 'Security: open door is detected, but we are not home.'
      data:
        push:
          category: alarm
    service: notify.all_iphones
  - wait_for_trigger:
      platform: event
      event_type: ios.notification_action_fired
      event_data:
        actionName: SOUND_ALARM
    timeout: 01:00:00
    continue_on_timeout: false
  - service: light.turn_on
    entity_id: all
    data:
      flash: long
      color_name: red
  mode: single
- id: '1594631215761'
  alias: Vacation Mode
  description: Vacation Mode
  trigger:
  - entity_id: input_boolean.vacation_mode
    from: 'off'
    platform: state
    to: 'on'
  condition: []
  action:
  - entity_id: input_boolean.alarm_clock_status
    service: input_boolean.turn_off
  - data: {}
    service: script.turn_off_everything
  - service: climate.set_preset_mode
    data:
      preset_mode: away
    entity_id: climate.wohnzimmer
  mode: single
- id: '1594631698389'
  alias: 'Vacation mode: auto turn on'
  description: ''
  trigger:
  - entity_id: group.persons
    for: '24:00:00'
    from: home
    platform: state
    to: not_home
  condition:
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'off'
  action:
  - entity_id: input_boolean.vacation_mode
    service: input_boolean.turn_on
  - data:
      message: No one at home for 24 hours, switching on vacation mode.
      title: Vacation mode
    service: notify.all_iphones
  initial_state: 'on'
  mode: single
- id: '1594631785192'
  alias: 'Vacation mode: auto turn off'
  initial_state: 'on'
  description: ''
  trigger:
  - entity_id: group.persons
    from: not_home
    platform: state
    to: home
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'on'
  action:
  - entity_id: input_boolean.vacation_mode
    service: input_boolean.turn_off
  - data:
      message: Welcome back! Switching off the vacation mode.
      title: Vacation mode
    service: notify.all_iphones
- id: '1595754875510'
  alias: 'Schlafzimmer - Hue Dimmer: Light on'
  description: ''
  trigger:
  - device_id: fb41032420324dd5b3a7ac88cedb2fb9
    domain: deconz
    platform: device
    subtype: turn_on
    type: remote_button_short_press
  condition: []
  action:
  - data: {}
    entity_id: switch.configuration_tool_1
    service: switch.turn_on
  - data: {}
    entity_id: light.schlafzimmerbeleuchtung
    service: light.turn_on
  mode: single
- id: '1595755790532'
  alias: 'Schlafzimmer - Hue Dimmer: Light off'
  description: ''
  trigger:
  - device_id: fb41032420324dd5b3a7ac88cedb2fb9
    domain: deconz
    platform: device
    subtype: turn_off
    type: remote_button_short_press
  condition: []
  action:
  - data: {}
    entity_id: light.schlafzimmerbeleuchtung
    service: light.turn_off
  - data: {}
    entity_id: switch.configuration_tool_1
    service: switch.turn_off
  mode: single
- id: '1595757412339'
  alias: Schlafzimmer Hue Dimmer - Brightness
  description: ''
  trigger:
  - device_id: fb41032420324dd5b3a7ac88cedb2fb9
    domain: deconz
    platform: device
    subtype: dim_up
    type: remote_button_short_press
  - device_id: fb41032420324dd5b3a7ac88cedb2fb9
    domain: deconz
    platform: device
    subtype: dim_down
    type: remote_button_short_press
  condition: []
  action:
  - data:
      group: light.schlafzimmerbeleuchtung
    service: script.increase_brightness
  mode: single
- id: '1595841289664'
  alias: 'Lovelace: Set theme at startup'
  description: ''
  trigger:
  - event: start
    platform: homeassistant
  condition: []
  action:
  - data:
      name: ios-dark-mode-blue-red
    service: frontend.set_theme
  mode: single
- id: '1595842159751'
  alias: 'Music: Reduce the volume if Jana comes home'
  description: Reduce the volume when Jana comes home
  trigger:
  - entity_id: person.jana
    from: not_home
    platform: state
    to: home
  condition:
  - condition: device
    device_id: e945b29ee4bc455b9d3f5dc4703f8a76
    domain: media_player
    entity_id: media_player.living_room
    type: is_on
  - condition: state
    entity_id: person.benjamin
    state: home
  action:
  - data:
      volume_level: '0.10'
    entity_id: media_player.living_room
    service: media_player.volume_set
  - data:
      volume_level: '0.10'
    entity_id: media_player.living_room_2
    service: media_player.volume_set
  - service: media_player.select_source
    data:
      source: NDR 2 87.6 (Top 40 & Pop Music)
    entity_id: media_player.living_room
  mode: single
- id: '1596457636424'
  alias: 'Utilities: washing machine has started'
  description: ''
  trigger:
  - entity_id: binary_sensor.washing_machine
    from: 'off'
    platform: state
    to: 'on'
  condition: []
  action:
  - data_template:
      datetime: '{{ now().strftime(''%Y-%m-%d %H:%M:%S'') }}'
    entity_id: input_datetime.washing_machine_started
    service: input_datetime.set_datetime
  mode: single
- id: '1596457795706'
  alias: 'Utilities: washing machine is done'
  description: ''
  trigger:
  - entity_id: binary_sensor.washing_machine
    from: 'on'
    platform: state
    to: 'off'
  condition: []
  action:
  - data_template:
      datetime: '{{ now().strftime(''%Y-%m-%d %H:%M:%S'') }}'
    entity_id: input_datetime.washing_machine_done
    service: input_datetime.set_datetime
  - data:
      message: Washing machine is done üëöüëï
      title: Utilities
    service: notify.all_iphones
  mode: single
- alias: 'Work: go home notification'
  trigger:
    platform: state
    entity_id: binary_sensor.worked_enough_today
    from: 'off'
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: state
    entity_id: input_boolean.work_hour_notification_sent
    state: 'off'
  action:
  - service: notify.mobile_app_iphone_bn
    data:
      title: Work
      message: You have worked 8 hours today, very good! Go home üéâ
  - service: input_boolean.turn_on
    entity_id: input_boolean.work_hour_notification_sent
  id: f5657aa03ef649e08af3a756b305764c
- alias: 'Work: reset input_boolean at midnight'
  trigger:
    platform: time
    at: 00:00
  condition:
    condition: state
    entity_id: input_boolean.work_hour_notification_sent
    state: 'on'
  action:
    service: input_boolean.turn_off
    entity_id: input_boolean.work_hour_notification_sent
  id: af9fd22a11674866af521fe4809d2d0a
- alias: 'Work: Benjamin left work notification for Jana'
  trigger:
    platform: state
    entity_id: person.benjamin
    from: Work
  condition:
    condition: time
    after: '16:00:00'
    before: '20:00:00'
  action:
    service: notify.mobile_app_iphone
    data:
      title: Work
      message: Benni has left work! ‚ô•Ô∏èüéâ
  id: 68b82abc4319442b930f8d8e5d7d97f9
- id: '1600624030295'
  alias: 'Air Purifier: Change mode'
  description: ''
  trigger:
  - platform: state
    entity_id: input_select.xiaomi_air_purifier_3h_mode
  condition: []
  action:
  - service: fan.set_speed
    data:
      speed: '{{ states(''input_select.xiaomi_air_purifier_3h_mode'') }}'
    entity_id: fan.xiaomi_air_purifier_3h
  mode: single
- id: '1600624273509'
  alias: 'Air Purifier: auto turn off'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.xiaomi_air_purifier_3h_pm25
    below: '5'
    for: 0:05:00
  condition:
  - condition: state
    entity_id: fan.xiaomi_air_purifier_3h
    state: 'on'
  action:
  - service: fan.turn_off
    data: {}
    entity_id: fan.xiaomi_air_purifier_3h
  - service: notify.all_iphones
    data:
      message: Air Purifier ausgeschaltet üõë
      title: Luftreiniger
  mode: single
- id: '1600624470835'
  alias: 'Air Purifier: auto turn on'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.xiaomi_air_purifier_3h_pm25
    for: 0:05:00
    above: '25'
  condition:
  - condition: state
    entity_id: fan.xiaomi_air_purifier_3h
    state: 'off'
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'off'
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'off'
  action:
  - data: {}
    entity_id: fan.xiaomi_air_purifier_3h
    service: fan.turn_on
  - data:
      speed: Auto
    entity_id: fan.xiaomi_air_purifier_3h
    service: fan.set_speed
  - service: notify.all_iphones
    data:
      message: Air Purifier angeschaltet üí®
      title: Luftreiniger
  mode: single
- id: '1601225820971'
  alias: 'Utilities: Set Strava Weight from Garmin'
  description: IFTTT Webhook
  trigger:
  - platform: state
    entity_id: sensor.weight
  condition: []
  action:
  - service: rest_command.set_strava_weight
    data:
      weight: '{{ states(''sensor.weight'') }}'
  mode: single
- id: '1602260519154'
  alias: 'Music: Turn off music if tv switch on'
  description: ''
  trigger:
  - platform: state
    entity_id: media_player.sony_bravia_tv
    from: 'off'
    to: 'on'
  condition:
  - condition: device
    device_id: e945b29ee4bc455b9d3f5dc4703f8a76
    domain: media_player
    entity_id: media_player.living_room
    type: is_playing
  action:
  - service: media_player.media_stop
    data: {}
    entity_id: media_player.living_room
  mode: single
- id: '1605471414652'
  alias: 'Leaving: automatically turn off everything'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.someone_in_the_house_in_last_hour
    from: 'on'
    to: 'off'
    for: 00:01:00
  - platform: time_pattern
    hours: /1
  condition:
  - condition: state
    entity_id:
    - binary_sensor.no_one_home
    - binary_sensor.anything_on
    state: 'on'
  - condition: state
    entity_id:
    - binary_sensor.someone_in_the_house_in_last_hour
    - input_boolean.guest_mode
    state: 'off'
  action:
  - service: script.turn_off_everything
    data: {}
  - service: climate.set_preset_mode
    data:
      preset_mode: away
    entity_id: climate.wohnzimmer
  - service: notify.all_iphones
    data:
      data:
        title: Leaving
        message: Everything automatically turned off!
  mode: single
- id: '1605471897713'
  alias: ' Air Purifier: Change Mode to silent during night'
  description: ''
  trigger:
  - platform: state
    entity_id: fan.xiaomi_air_purifier_3h
    to: 'on'
  condition:
  - condition: time
    after: '21:30'
    before: 07:00
  - condition: state
    entity_id: fan.xiaomi_air_purifier_3h
    attribute: speed
    state: Auto
  action:
  - service: fan.set_speed
    data:
      speed: Silent
    entity_id: fan.xiaomi_air_purifier_3h
  mode: single
- id: '1605518936109'
  alias: 'Light: turn off living bedroom'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.activity_in_bedroom
    from: 'on'
    to: 'off'
  condition:
  - condition: state
    entity_id: light.schlafzimmerbeleuchtung
    state: 'on'
  action:
  - service: light.turn_off
    data: {}
    entity_id: light.schlafzimmerbeleuchtung
  mode: single
- id: '1605532116468'
  alias: 'Light: turn off living room'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.activity_in_livingroom
    from: 'on'
    to: 'off'
    for: 01:00:00
  action:
  - service: light.turn_off
    data:
      entity_id:
      - light.wohnzimmerbeleuchtung
      - light.kuchenbeleuchtung
      transition: 1
  mode: single
- alias: 'Light: turn off living sportroom'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.activity_in_sportroom
    from: 'on'
    to: 'off'
  action:
  - service: light.turn_off
    data: {}
    entity_id:
    - light.sportzimmerbeleuchtung
    - light.color_temperature_light_16
  mode: single
  id: d5cef8dc52de4eceb0e08ac4c9fa0547
- id: '1605607002952'
  alias: 'Music: Group Sonos Speaker'
  description: ''
  trigger:
  - platform: state
    entity_id: media_player.living_room
    to: 'on'
  condition: []
  action:
  - service: sonos.join
    data:
      master: media_player.living_room
    entity_id: media_player.living_room_2
  mode: single
- id: '1606308542509'
  alias: Test
  description: ''
  trigger:
  - platform: sun
    event: sunset
  condition: []
  action:
  - service: climate.set_preset_mode
    data:
      preset_mode: auto
    entity_id: climate.wohnzimmer
  mode: single
- id: '1606309469989'
  alias: 'Arriving: Set Tado Mode to home'
  description: ''
  trigger:
  - platform: state
    entity_id: group.persons
    from: not_home
    to: home
  condition: []
  action:
  - service: climate.set_preset_mode
    data:
      preset_mode: home
    entity_id: climate.wohnzimmer
  mode: single
- id: '1606309549076'
  alias: 'Arriving: Set Tado Mode to away'
  description: ''
  trigger:
  - platform: state
    entity_id: group.persons
    from: home
    to: not_home
  condition: []
  action:
  - service: climate.set_preset_mode
    data:
      preset_mode: away
    entity_id: climate.wohnzimmer
  mode: single
